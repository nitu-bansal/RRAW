/// <reference path="http://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js" />
/// <reference path="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js" />
/// <reference path="Tabs.min.js" />
var errCode = -1;
var quotes;
var rates;
var maxJSONCollectionCount = 2;
var parties;
var UOMs;
var ChargeTypes;

$(document).ready(function () {
    GetAllMasters();     
})

function GetAllMasters() {
    RRAW.WebServices.Authentications.GetAllMasters(AuthenticationToken(), onSuccessOfGetAllMasters, onFailureOfGetAllMasters);
}
function onFailureOfGetAllMasters(res) {
    window.location = "Errors.aspx?Operation=GetAllMasters&ExceptionType=" + res._exceptionType + "&Msg=" + res._message + "&StackTrace=" + res._stackTrace + "&TimedOut=" + res._timedOut;
}

function onSuccessOfGetAllMasters(res) {
    var masters = res;

    if (masters == undefined) {
        if (mastersJSONCollectionCount <= maxJSONCollectionCount) {
            mastersJSONCollectionCount++;
            GetAllMasters();
            return;
        }
    }
    onSuccessOfGetAllClients(masters["GetAllClients"]);
    parties = masters["GetAllParties"];    
    ChargeTypes = masters["GetAllchargeTypes"];
    mastersLoadComplete = true;    
}
function onSuccessOfGetAllClients(res) {
    if (Number(res) != NaN && (res == errCode || res == 0)) {
        DisplayError("Unknown error has occured. Please contact Administrator");
        return errCode;
    }
    var Clients = res;

    $("#cmbClient").children().remove();
    $("#cmbClientRates").children().remove();    

    $('#cmbClient').append($("<option></option>").attr("value", "0").text("Select"));
    $('#cmbClientRates').append($("<option></option>").attr("value", "0").text("Select"));    


    $.each(Clients, function (key, val) {
        $('#cmbClient').append($("<option></option>").attr("value", key).text(val));
        $('#cmbClientRates').append($("<option></option>").attr("value", key).text(val));        

    });

}

//------------------------------------------------------------Quotes..............................................................

function onSuccessOfGetCustomizeUI(res) {
    if (res["AuthenticationError"] != undefined) {
        window.location = res["AuthenticationError"][0];
    }
    quotes = res;
    Fillquotes();
}

function RefillAllData() {
    RRAW.WebServices.Authentications.GetCustomizeUI(GetCookie("AuthenticationToken"), $("#cmbClient option:selected").attr('value'), onSuccessOfGetCustomizeUI);
}

function Fillquotes() {
    var Color = "#800000";
    $("#divQuotes").children().remove();
    $("#divQuotes").append("<div><div style='font-weight:bold;margin-bottom: 15px;color:#800000'>Users Access Format:</div><table   id='tblFormValidation' width='100%'  cellpadding='0' cellspacing='0'><thead><tr style='background-color: activeborder;font-size: 12px;font-weight: bold;'><td style='Width:14%;'>Field</td><td  style='Width:10%;text-align:center'>IsDefault(Air/Ocean/Ground)</td><td style='Width:10%;text-align:center;'>Air</td><td style='Width:10%;text-align:center;'>Ocean</td><td style='Width:10%;text-align:center;'>Ground</td><td style='Width:10%;text-align:left;'>Sequence</td><td style='Width:7%;text-align:left;'></td><td style='Width:5%;text-align:left;'></td><td style='Width:4%;text-align:left;'></td></thead></table></div>");
    var i = 0;

    $.each(quotes["CustomizeUI"], function (key, val) {
        if (i == 0) {
            $('#tblFormValidation').append("<tr style='border:1px solid #DAE3F6;background-color:#EFF3FB;color:" + Color + ";height:25px;'  id='" + key + "'><td>" + val.Field + "</td>" + "<td>" + CreateChkBox("chkIsDefault_" + val.FMID + "_" + val.ClientID, val.IsDefault, "TRUE") + "</td>" + "<td>" + CreateChkBox("chk_" + val.FMID + "_" + val.ClientID + "_1", val.Air, val.IsDefault) + "</td>" + "<td>" + CreateChkBox("chk_" + val.FMID + "_" + val.ClientID + "_2", val.Ocean, val.IsDefault) + "</td>" + "<td>" + CreateChkBox("chk_" + val.FMID + "_" + val.ClientID + "_3", val.Ground, val.IsDefault) + "</td>" + "<td><span id='span_" + val.FMID + "_" + val.ClientID + "'>" + val.DisplayOrder + "</span></td>" + "<td>" + CreateButton("btnEdit_" + val.FMID + "_" + val.ClientID, val.Exist, "0") + "</td>" + "<td>" + CreateImageSequence("imgUp_" + val.FMID + "_" + val.ClientID, "UP", "Images/Up_img.png") + "</td><td>" + CreateImageSequence("imgDown_" + val.FMID + "_" + val.ClientID, "Down", "Images/Down_img.png") + "</td></tr>");
            i = 1;
        }
        else {
            $('#tblFormValidation').append("<tr style='border:1px solid #DAE3F6;color:" + Color + ";height:25px;'  id='" + key + "'><td>" + val.Field + "</td>" + "<td>" + CreateChkBox("chkIsDefault_" + val.FMID + "_" + val.ClientID, val.IsDefault, "TRUE") + "</td>" + "<td>" + CreateChkBox("chk_" + val.FMID + "_" + val.ClientID + "_1", val.Air, val.IsDefault) + "</td>" + "<td>" + CreateChkBox("chk_" + val.FMID + "_" + val.ClientID + "_2", val.Ocean, val.IsDefault) + "</td>" + "<td>" + CreateChkBox("chk_" + val.FMID + "_" + val.ClientID + "_3", val.Ground, val.IsDefault) + "</td>" + "<td><span id='span_" + val.FMID + "_" + val.ClientID + "'>" + val.DisplayOrder + "</span></td>" + "<td>" + CreateButton("btnEdit_" + val.FMID + "_" + val.ClientID, val.Exist, "0") + "</td><td>" + CreateImageSequence("imgUp_" + val.FMID + "_" + val.ClientID, "UP", "Images/Up_img.png") + "</td><td>" + CreateImageSequence("imgDown_" + val.FMID + "_" + val.ClientID, "Down", "Images/Down_img.png") + "</td></tr>");
            i = 0;
        }
    });
    $("[id^='chk_28_']").attr("disabled", "disabled");
    $("[id^='chk_29_']").attr("disabled", "disabled");
    $("[id^='chk_30_']").attr("disabled", "disabled");
    $("[id^='chk_31_']").attr("disabled", "disabled");
}

$("[id^='chk_27']").live("click", function () {
    var TransportId = ($(this).attr("id").split('_')[3]).toString();
    var CLID = ($(this).attr("id").split('_')[2]).toString();

    if ($(this).is(":checked")) {
        $("[id^='chk_28_" +CLID+"_"+TransportId+"']").attr("checked", "checked");

    }
    else {
        $("[id^='chk_28_" + CLID + "_" + TransportId + "']").removeAttr('checked');
    }

});


$("[id^='chk_32']").live("click", function () {
    var TransportId = ($(this).attr("id").split('_')[3]).toString();
    var CLID = ($(this).attr("id").split('_')[2]).toString();

    if ($(this).is(":checked")) {
        $("[id^='chk_29_" + CLID + "_" + TransportId + "']").attr("checked", "checked");
        $("[id^='chk_30_" + CLID + "_" + TransportId + "']").attr("checked", "checked");
        $("[id^='chk_31_" + CLID + "_" + TransportId + "']").attr("checked", "checked");

    }
    else {
        $("[id^='chk_29_" + CLID + "_" + TransportId + "']").removeAttr('checked');
        $("[id^='chk_30_" + CLID + "_" + TransportId + "']").removeAttr('checked');
        $("[id^='chk_31_" + CLID + "_" + TransportId + "']").removeAttr('checked');
    }

});


$("#cmbClient").change(function () {
    if ($("#cmbClient option:selected").attr('value').toString() != "0") {
        RefillAllData();
    }
    else {
        $("#divQuotes").children().remove();
    }

});


$("[id^='btnEdit_']").live("click", function (e) {

    var TransportModeId;
    var ClientId;
    var FieldId;
    ClientId = ($(this).attr("id").split('_')[2]).toString();
    FieldId = ($(this).attr("id").split('_')[1]).toString();

    if ($("#chkIsDefault_" + FieldId + "_" + ClientId).attr("checked") == undefined) {
        $.each($("[id^='chk_" + FieldId + "_" + ClientId + "_']"), function (key, item) {
            if ($(this).attr("checked") != undefined) {


                RRAW.WebServices.Authentications.InsertCustomizeUI(($(this).attr("id").split('_')[2]).toString(), "TRUE", ($(this).attr("id").split('_')[1]).toString(), ($(this).attr("id").split('_')[3]).toString(), $("#span_" + FieldId + "_" + ClientId).text());
                if (FieldId == 27) {
                    RRAW.WebServices.Authentications.InsertCustomizeUI(($(this).attr("id").split('_')[2]).toString(), "TRUE", "28", ($(this).attr("id").split('_')[3]).toString(),0);
                }
                else if (FieldId == 32) {
                    RRAW.WebServices.Authentications.InsertCustomizeUI(($(this).attr("id").split('_')[2]).toString(), "TRUE", "29", ($(this).attr("id").split('_')[3]).toString(), 0);
                    RRAW.WebServices.Authentications.InsertCustomizeUI(($(this).attr("id").split('_')[2]).toString(), "TRUE", "30", ($(this).attr("id").split('_')[3]).toString(), 0);
                    RRAW.WebServices.Authentications.InsertCustomizeUI(($(this).attr("id").split('_')[2]).toString(), "TRUE", "31", ($(this).attr("id").split('_')[3]).toString(), 0);
                }

            }
            else {
                RRAW.WebServices.Authentications.DeleteCustomizeUI(($(this).attr("id").split('_')[2]).toString(), "TRUE", ($(this).attr("id").split('_')[1]).toString(), ($(this).attr("id").split('_')[3]).toString());
                if (FieldId == 27) {
                    RRAW.WebServices.Authentications.DeleteCustomizeUI(($(this).attr("id").split('_')[2]).toString(), "TRUE", "28", ($(this).attr("id").split('_')[3]).toString());
                }
                else if (FieldId == 32) {
                    RRAW.WebServices.Authentications.DeleteCustomizeUI(($(this).attr("id").split('_')[2]).toString(), "TRUE", "29", ($(this).attr("id").split('_')[3]).toString());
                    RRAW.WebServices.Authentications.DeleteCustomizeUI(($(this).attr("id").split('_')[2]).toString(), "TRUE", "30", ($(this).attr("id").split('_')[3]).toString());
                    RRAW.WebServices.Authentications.DeleteCustomizeUI(($(this).attr("id").split('_')[2]).toString(), "TRUE", "31", ($(this).attr("id").split('_')[3]).toString());
                }
            }
        });
    }
    RefillAllData();
});



$("[id^='imgUp_']").live("click", function (e) {
    var currentClientID;
    var currentFieldID;
    var currentSequence;
    var PrevClientID;
    var PrevFieldID;
    var PrevSequence;
    if ($(this).closest('td').parent().prev().children("td:eq(2)").children(0).attr("id") != undefined) {
        currentFieldID = $(this).closest('td').parent().children("td:eq(2)").children(0).attr("id").split('_')[1].toString();
        currentClientID = $(this).closest('td').parent().children("td:eq(2)").children(0).attr("id").split('_')[2].toString();
        currentSequence = $(this).closest('td').parent().children("td:eq(5)").children(0).html();

        PrevFieldID = $(this).closest('td').parent().prev().children("td:eq(2)").children(0).attr("id").split('_')[1].toString();
        PrevClientID = $(this).closest('td').parent().prev().children("td:eq(2)").children(0).attr("id").split('_')[2].toString();
        PrevSequence = $(this).closest('td').parent().prev().children("td:eq(5)").children(0).html();

        if (PrevSequence != 0 && currentSequence != 0) {
            RRAW.WebServices.Authentications.UpdateCustomizeUISequence(currentClientID, "TRUE", currentFieldID, PrevSequence);
            RRAW.WebServices.Authentications.UpdateCustomizeUISequence(PrevClientID, "TRUE", PrevFieldID, currentSequence);

            RefillAllData();
        }
        else {
            alert("sequence can not be update");
        }
    }
});

$("[id^='imgDown_']").live("click", function (e) {
    var currentClientID;
    var currentFieldID;
    var currentSequence;
    var nextClientID;
    var nextFieldID;
    var nextSequence;

    if ($(this).closest('td').parent().next().children("td:eq(2)").children(0).attr("id") != undefined) {
        currentFieldID = $(this).closest('td').parent().children("td:eq(2)").children(0).attr("id").split('_')[1].toString();
        currentClientID = $(this).closest('td').parent().children("td:eq(2)").children(0).attr("id").split('_')[2].toString();
        currentSequence = $(this).closest('td').parent().children("td:eq(5)").children(0).html();

        nextFieldID = $(this).closest('td').parent().next().children("td:eq(2)").children(0).attr("id").split('_')[1].toString();
        nextClientID = $(this).closest('td').parent().next().children("td:eq(2)").children(0).attr("id").split('_')[2].toString();
        nextSequence = $(this).closest('td').parent().next().children("td:eq(5)").children(0).html();

        if (nextSequence != 0 && currentSequence != 0) {
            RRAW.WebServices.Authentications.UpdateCustomizeUISequence(currentClientID, "TRUE", currentFieldID, nextSequence);
            RRAW.WebServices.Authentications.UpdateCustomizeUISequence(nextClientID, "TRUE", nextFieldID, currentSequence);

            RefillAllData();
        }
        else {
            alert("sequence can not be update");
        }
    }

});

//...................................End Quotes.....................................................

//-----------------------------------Rates-----------------------------------------------------------



function onSuccessOfGetCustomizeRatesUI(res) {
    if (res["AuthenticationError"] != undefined) {
        window.location = res["AuthenticationError"][0];
    }
    rates = res;
    Fillrates();
}

function RefillAllData_Rates() {
    RRAW.WebServices.Authentications.GetCustomizeRatesUI(GetCookie("AuthenticationToken"), $("#cmbClientRates option:selected").attr('value'), $("#cmbMode option:selected").attr('value'), onSuccessOfGetCustomizeRatesUI);
}



$("#cmbClientRates").change(function () {
    if ($("#cmbClientRates option:selected").attr('value').toString() != "0" && $("#cmbMode option:selected").attr('value').toString() != "0") {
        GetAllUOMs()
        RefillAllData_Rates();
    }
    else {
        $("#divRates").children().remove();
    }

});

$("#cmbMode").change(function () {
    if ($("#cmbClientRates option:selected").attr('value').toString() != "0" && $("#cmbMode option:selected").attr('value').toString() != "0") {
        GetAllUOMs();
        RefillAllData_Rates();
    }
    else {
        $("#divRates").children().remove();
    }
});

function GetAllUOMs() {

    RRAW.WebServices.Authentications.GetAllUOMs(AuthenticationToken(), $("#cmbMode option:selected").attr('value').toString(), onSuccessOfGetAllUOMs, onFailureOfGetAllUOMs);

}
function onFailureOfGetAllUOMs(res) {
    window.location = "Errors.aspx?Operation=GetAllUOMs&ExceptionType=" + res._exceptionType + "&Msg=" + res._message + "&StackTrace=" + res._stackTrace + "&TimedOut=" + res._timedOut;
}

function onSuccessOfGetAllUOMs(res) {
    var masters = res;

    if (masters == undefined) {
        if (mastersJSONCollectionCount <= maxJSONCollectionCount) {
            mastersJSONCollectionCount++;
            GetAllUOMs();
            return;
        }
    }
    UOMs = masters["GetAllUOMs"];
}




$("[id^='btnEditRates_']").live("click", function (e) {

    
    var TransportModeId;
    var ClientId;
    var RateId;
    var IsRangetariff;
    var IsCurrency;
    var IsConvertToCurrency;
    var IsCurrencyConversionApply;

    ClientId = ($(this).attr("id").split('_')[2]).toString();
    RateId = ($(this).attr("id").split('_')[1]).toString();
    $.each($("[id^='chkRates_" + RateId + "_" + ClientId + "_']"), function (key, item) {
        TransportModeId = ($(this).attr("id").split('_')[3]).toString();
        if ($(this).attr("checked") != undefined) {
            if ($("#chkIsRangeTariff_" + RateId + "_" + ClientId + "_" + TransportModeId).attr("checked") != undefined) {
                IsRangetariff = "TRUE";
            }
            else {
                IsRangetariff = "FALSE";
            }

            if ($("#chkIsCurrency_" + RateId + "_" + ClientId + "_" + TransportModeId).attr("checked") != undefined) {
                IsCurrency = "TRUE";
            }
            else {
                IsCurrency = "FALSE";
            }

            if ($("#chkIsConvertToCurrency_" + RateId + "_" + ClientId + "_" + TransportModeId).attr("checked") != undefined) {
                IsConvertToCurrency = "TRUE";
            }
            else {
                IsConvertToCurrency = "FALSE";
            }

            if ($("#chkIsCurrencyConversionApply_" + RateId + "_" + ClientId + "_" + TransportModeId).attr("checked") != undefined) {
                IsCurrencyConversionApply = "TRUE";
            }
            else {
                IsCurrencyConversionApply = "FALSE";
            }
            RRAW.WebServices.Authentications.InsertCustomizeRatesUI(ClientId, "TRUE", RateId, TransportModeId, $("#spanRates_" + RateId + "_" + ClientId).text(), $("#cmbPartType_" + RateId + "_" + ClientId + "_" + TransportModeId + "  option:selected").val(), $("#cmbUOM_" + RateId + "_" + ClientId + "_" + TransportModeId + "  option:selected").val(), IsRangetariff, IsCurrency, IsConvertToCurrency
            ,IsCurrencyConversionApply, $("#cmbChargeType_" + RateId + "_" + ClientId + "_" + TransportModeId + "  option:selected").val());
        }
        else {
            RRAW.WebServices.Authentications.DeleteCustomizeRatesUI(ClientId, "TRUE", RateId, TransportModeId);
        }
    });

    RefillAllData_Rates();
});


function Fillrates() {
    var Color = "#800000";
    $("#divRates").children().remove();
    var ModeHeader = $("#cmbMode option:selected").text();
    $("#divRates").append("<div><div  style='font-weight:bold; margin-bottom: 15px;color:#800000'>Users Access Format:</div><table border='0'  id='tblFormValidation_Rates' width='100%'  cellpadding='0' cellspacing='0'><thead><tr style='background-color: activeborder;font-size: 12px;font-weight: bold;'><td style='Width:11%;'>Rate</td><td style='Width:6%;text-align:center;'>" + ModeHeader + " </td><td style='Width:9%;'>IsRangeTariff</td><td style='Width:8%;text-align:left;'>Party</td><td style='Width:8%;text-align:left;'>UOM</td><td style='Width:7%;text-align:left;'>Charge Type</td><td style='Width:8%;text-align:center;'>Currency</td><td style='Width:12%;text-align:center;'>Currency Conversion Apply</td><td style='Width:7%;text-align:center;'>Convert To Currency</td><td style='Width:8%;text-align:left;'>Sequence</td><td style='Width:6%;text-align:left;'></td><td style='Width:5%;text-align:left;'></td><td style='Width:7%;text-align:left;'></td></thead></table></div>");
    var i = 0;

    $.each(rates["CustomizeRateUI"], function (key, val) {
        if (i == 0) {
            $('#tblFormValidation_Rates').append("<tr style='border:1px solid #DAE3F6;background-color:#EFF3FB;color:" + Color + ";height:25px;'  id='" + key + "'><td>" + val.Rate + "</td>" + "<td>" + CreateChkBox("chkRates_" + val.RMID + "_" + val.ClientID + "_" + val.ModeID, val.Mode, val.IsDefault) + "</td>" + "<td>" + CreateChkBox("chkIsRangeTariff_" + val.RMID + "_" + val.ClientID + "_" + val.ModeID, val.IsRangeTariff, val.IsDefault) + "</td>" + "<td>" + CreateDropDown("cmbPartType_" + val.RMID + "_" + val.ClientID + "_" + val.ModeID, val["PartyID"], parties, "") + "</td>" + "<td>" + CreateDropDown("cmbUOM_" + val.RMID + "_" + val.ClientID + "_" + val.ModeID, val["UOMID"], UOMs, "") + "</td>" + "<td>" + CreateDropDown("cmbChargeType_" + val.RMID + "_" + val.ClientID + "_" + val.ModeID, val["ChargeTypeID"], ChargeTypes, "") + "</td>" + "<td>" + CreateChkBox("chkIsCurrency_" + val.RMID + "_" + val.ClientID + "_" + val.ModeID, val.IsCurrency, val.IsDefault) + "</td>" + "<td>" + CreateChkBox("chkIsCurrencyConversionApply_" + val.RMID + "_" + val.ClientID + "_" + val.ModeID, val.IsCurrencyConversionApply, val.IsDefault) + "</td>" + "<td>" + CreateChkBox("chkIsConvertToCurrency_" + val.RMID + "_" + val.ClientID + "_" + val.ModeID, val.IsConvertToCurrency, val.IsDefault) + "</td>" + "<td><span id='spanRates_" + val.RMID + "_" + val.ClientID + "'>" + val.DisplayOrder + "</span></td>" + "<td>" + CreateButton("btnEditRates_" + val.RMID + "_" + val.ClientID, val.Exist, "0") + "</td>" + "<td>" + CreateImageSequence("imgUpRates_" + val.RMID + "_" + val.ClientID, "UP", "Images/Up_img.png") + "</td><td>" + CreateImageSequence("imgDownRates_" + val.RMID + "_" + val.ClientID, "Down", "Images/Down_img.png") + "</td></tr>");
            i = 1;
        }
        else {
            $('#tblFormValidation_Rates').append("<tr style='border:1px solid #DAE3F6;color:" + Color + ";height:25px;'  id='" + key + "'><td>" + val.Rate + "</td>" + "<td>" + CreateChkBox("chkRates_" + val.RMID + "_" + val.ClientID + "_" + val.ModeID, val.Mode, val.IsDefault) + "</td>" + "<td>" + CreateChkBox("chkIsRangeTariff_" + val.RMID + "_" + val.ClientID + "_" + val.ModeID, val.IsRangeTariff, val.IsDefault) + "</td>" + "<td>" + CreateDropDown("cmbPartType_" + val.RMID + "_" + val.ClientID + "_" + val.ModeID, val["PartyID"], parties, "") + "</td>" + "<td>" + CreateDropDown("cmbUOM_" + val.RMID + "_" + val.ClientID + "_" + val.ModeID, val["UOMID"], UOMs, "") + "</td>" + "<td>" + CreateDropDown("cmbChargeType_" + val.RMID + "_" + val.ClientID + "_" + val.ModeID, val["ChargeTypeID"], ChargeTypes, "") + "</td>" + "<td>" + CreateChkBox("chkIsCurrency_" + val.RMID + "_" + val.ClientID + "_" + val.ModeID, val.IsCurrency, val.IsDefault) + "</td>" + "<td>" + CreateChkBox("chkIsCurrencyConversionApply_" + val.RMID + "_" + val.ClientID + "_" + val.ModeID, val.IsCurrencyConversionApply, val.IsDefault) + "</td>" + "<td>" + CreateChkBox("chkIsConvertToCurrency_" + val.RMID + "_" + val.ClientID + "_" + val.ModeID, val.IsConvertToCurrency, val.IsDefault) + "</td>" + "<td><span id='spanRates_" + val.RMID + "_" + val.ClientID + "'>" + val.DisplayOrder + "</span></td>" + "<td>" + CreateButton("btnEditRates_" + val.RMID + "_" + val.ClientID, val.Exist, "0") + "</td>" + "<td>" + CreateImageSequence("imgUpRates_" + val.RMID + "_" + val.ClientID, "UP", "Images/Up_img.png") + "</td><td>" + CreateImageSequence("imgDownRates_" + val.RMID + "_" + val.ClientID, "Down", "Images/Down_img.png") + "</td></tr>");
            i = 0;
        }
    });

    $("[id^='chkIsConvertToCurrency_']").attr("disabled", "disabled");
}




$("[id^='imgUpRates_']").live("click", function (e) {
    var currentClientID;
    var currentRateID;
    var currentSequence;
    var PrevClientID;
    var PrevRateID;
    var PrevSequence;
    if ($(this).closest('td').parent().prev().children("td:eq(1)").children(0).attr("id") != undefined) {
        currentRateID = $(this).closest('td').parent().children("td:eq(1)").children(0).attr("id").split('_')[1].toString();
        currentClientID = $(this).closest('td').parent().children("td:eq(1)").children(0).attr("id").split('_')[2].toString();
        currentSequence = $(this).closest('td').parent().children("td:eq(9)").children(0).html();

        PrevRateID = $(this).closest('td').parent().prev().children("td:eq(1)").children(0).attr("id").split('_')[1].toString();
        PrevClientID = $(this).closest('td').parent().prev().children("td:eq(1)").children(0).attr("id").split('_')[2].toString();
        PrevSequence = $(this).closest('td').parent().prev().children("td:eq(9)").children(0).html();

        if (PrevSequence != 0 && currentSequence != 0) {
            RRAW.WebServices.Authentications.UpdateCustomizeRatesUISequence(currentClientID, "TRUE", currentRateID, PrevSequence);
            RRAW.WebServices.Authentications.UpdateCustomizeRatesUISequence(PrevClientID, "TRUE", PrevRateID, currentSequence);

            RefillAllData_Rates();
        }
        else {
            alert("sequence can not be update");
        }
    }    
});




$("[id^='imgDownRates_']").live("click", function (e) {
    var currentClientID;
    var currentRateID;
    var currentSequence;
    var nextClientID;
    var nextRateID;
    var nextSequence;
    if ($(this).closest('td').parent().next().children("td:eq(1)").children(0).attr("id") != undefined) {
        currentRateID = $(this).closest('td').parent().children("td:eq(1)").children(0).attr("id").split('_')[1].toString();
        currentClientID = $(this).closest('td').parent().children("td:eq(1)").children(0).attr("id").split('_')[2].toString();
        currentSequence = $(this).closest('td').parent().children("td:eq(9)").children(0).html();

        nextRateID = $(this).closest('td').parent().next().children("td:eq(1)").children(0).attr("id").split('_')[1].toString();
        nextClientID = $(this).closest('td').parent().next().children("td:eq(1)").children(0).attr("id").split('_')[2].toString();
        nextSequence = $(this).closest('td').parent().next().children("td:eq(9)").children(0).html();

        if (nextSequence != 0 && currentSequence != 0) {
            RRAW.WebServices.Authentications.UpdateCustomizeRatesUISequence(currentClientID, "TRUE", currentRateID, nextSequence);
            RRAW.WebServices.Authentications.UpdateCustomizeRatesUISequence(nextClientID, "TRUE", nextRateID, currentSequence);

            RefillAllData_Rates();
        }
        else {
            alert("sequence can not be update");
        }
    }
});



//---------------------------------------------------Rates End---------------------------------------------------------------------------


//--------------------------------------------------General------------------------------------------------------------------------------


function CreateChkBox(ControlID, JsonVal, IsDisabled) {    
    var selct = "<input type='checkbox' id='" + ControlID + "' style='width:93%' value='" + JsonVal + "'" + ((JsonVal.toUpperCase() == "TRUE") || (JsonVal.toUpperCase() == "1") ? " checked='checked'" : "") + ((IsDisabled.toString().toUpperCase() == "TRUE") || (IsDisabled.toString().toUpperCase() == "1") ? " disabled='disabled' " : "") + " />";    
    return selct;

}

function CreateImageSequence(ControlID, JsonVal,URL) {
    var selct = "";
    selct = "<img src='"+ URL+"' id='" + ControlID + "' alt='" + JsonVal + "'  height='20px' width='20px' />";
    return selct;
}

function CreateButton(ControlID, JsonVal, IsDisabled) {
    var selct = "";
    if (JsonVal == "1") {
        selct = "<input type='button' id='" + ControlID + "' value='Update'"+ ((IsDisabled.toString().toUpperCase() == "TRUE") || (IsDisabled.toString().toUpperCase() == "1") ? " disabled='disabled' " : "")+" />";
    }
    else {
        selct = "<input type='button' id='" + ControlID + "' value='Insert'" + ((IsDisabled.toString().toUpperCase() == "TRUE") || (IsDisabled.toString().toUpperCase() == "1") ? " disabled='disabled' " : "")+" />";
    }
    return selct;
}

function CreateDropDown(ControlID, JsonVal, DataArray, attr) {

    var selct;
    var Options = "";
    $.each(DataArray, function (key, val) {
        selct = "";
        if (key == JsonVal) {
            selct = "selected='selected'";
        }
        Options += "<option value='" + (key) + "' " + selct + ">" + val + "</option>";

    });

    selct = "<select id='" + ControlID + "' style='width:70%'" + attr + " required ><option value='0'>Select</option>" + Options + "</select>";
    return selct;

}


function DisplayError(errorMessage, control) {
    if (control != undefined) {
        $(control).focus();
    }

    alert(errorMessage);

    return 1;
}


function GetCookie(c_name) {
    var i, x, y, ARRcookies = document.cookie.split(";");
    for (i = 0; i < ARRcookies.length; i++) {
        x = ARRcookies[i].substr(0, ARRcookies[i].indexOf("="));
        y = ARRcookies[i].substr(ARRcookies[i].indexOf("=") + 1);
        x = x.replace(/^\s+|\s+$/g, "");
        if (x == c_name) {
            return unescape(y);
        }
    }
}

function AuthenticationToken() {
    return GetCookie("AuthenticationToken");
}




//-------------------------------------------------------------------------------------------------------------------------------------------------
