/// <reference path="http://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js" />

var memDownloadReport = false;

function onLoad() {
    try { top.document.getElementById('processing_image').style.display = 'none' } catch (e) { };

    var d = new Date();
    var monthNumber = d.getMonth() + 1;
    document.getElementById('selectMonth').selectedIndex = monthNumber - 1;

    UpdateMonthName(document.getElementById('selectMonth').options[document.getElementById('selectMonth').selectedIndex].text);

    //SummaryOfRequestsByMonth(monthNumber);
    //MonthlyApprovalTimeline(monthNumber);
    //NewLanesAddedInMonth(monthNumber);
    //MonthlyRequestFrequency();
}

function UpdateMonthName(monthName) {
    document.getElementById('selectedSummaryOfRequestsByMonthMonthName').innerHTML = monthName;
    document.getElementById('selectedNewLanesAddedInMonthMonthName').innerHTML = monthName;
    document.getElementById('selectedMonthlyApprovalTimelineMonthName').innerHTML = monthName;
}

function onSuccessOfSummaryOfRequestsByMonth(res) {
    document.getElementById("divSummaryOfRequestsByMonth").innerHTML += "<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href = '" + res + "'>Download <span style='font-weight: 700'>Summary Of Requests for " + document.getElementById('selectMonth').options[document.getElementById('selectMonth').selectedIndex].text + "</span></a>";
    if (memDownloadReport === true) {
        memDownloadReport = false;
        window.location = res;
    }
}

function SummaryOfRequestsByMonth(monthNumber, downloadReport) {
    memDownloadReport = downloadReport;
    RRAW.WebServices.Reports.SummaryOfRequestsByMonth(getCookie("AuthenticationToken"), monthNumber, onSuccessOfSummaryOfRequestsByMonth);
}

function onSuccessOfNewLanesAddedInMonth(res) {
    document.getElementById("divNewLanesAddedInMonth").innerHTML += "<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href = '" + res + "'>Download <span style='font-weight: 700'>New Lanes Added in " + document.getElementById('selectMonth').options[document.getElementById('selectMonth').selectedIndex].text + "</span></a>";
    if (memDownloadReport === true) {
        memDownloadReport = false;
        window.location = res;
    }
}

function GetApprovalTimelineForPendingRequests(downloadReport) {
    memDownloadReport = downloadReport;
    RRAW.WebServices.Reports.GetApprovalTimelineForPendingRequests(getCookie("AuthenticationToken"), onSuccessOfGetApprovalTimelineForPendingRequests);
}

function onSuccessOfGetApprovalTimelineForPendingRequests(res) {
    document.getElementById("divApprovalTimelineForPendingRequests").innerHTML += "<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href = '" + res + "'>Download <span style='font-weight: 700'>Approval Timeline For Pending Requests</span></a>";
    if (memDownloadReport === true) {
        memDownloadReport = false;
        window.location = res;
    }
}

function MonthlyApprovalTimeline(monthNumber, downloadReport) {
    memDownloadReport = downloadReport;
    RRAW.WebServices.Reports.MonthlyApprovalTimeline(getCookie("AuthenticationToken"), monthNumber, onSuccessOfMonthlyApprovalTimeline);
}

function onSuccessOfMonthlyApprovalTimeline(res) {
    document.getElementById("divMonthlyApprovalTimeline").innerHTML += "<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href = '" + res + "'>Download <span style='font-weight: 700'>Monthly Approval Timeline for " + document.getElementById('selectMonth').options[document.getElementById('selectMonth').selectedIndex].text + "</span></a>";
    if (memDownloadReport === true) {
        memDownloadReport = false;
        window.location = res;
    }
}

function PendingApprovalTimeline(downloadReport) {
	memDownloadReport = downloadReport;
	RRAW.WebServices.Reports.PendingApprovalTimeline(getCookie("AuthenticationToken"), onSuccessOfPendingApprovalTimeline);
}

function onSuccessOfPendingApprovalTimeline(res) {
	document.getElementById("divPendingApprovalTimeline").innerHTML = "<a href = '" + res + "'>Download <span style='font-weight: 700'>Pending Approval Timeline</span></a>";
	if (memDownloadReport === true) {
		memDownloadReport = false;
		window.location = res;
	}
}

function NewLanesAddedInMonth(monthNumber, downloadReport) {
    memDownloadReport = downloadReport;
    RRAW.WebServices.Reports.NewLanesAddedInMonth(getCookie("AuthenticationToken"), monthNumber, onSuccessOfNewLanesAddedInMonth);
}

function onSuccessOfMonthlyRequestFrequency(res) {
    document.getElementById("divMonthlyRequestFrequency").innerHTML = "<a href = '" + res + "'>Download <span style='font-weight: 700'>Origin - Destination Monthly Request Frequency</span></a>";
    if (memDownloadReport === true) {
        memDownloadReport = false;
        window.location = res;
    }
}

function MonthlyRequestFrequency(downloadReport) {
    memDownloadReport = downloadReport;
    RRAW.WebServices.Reports.MonthlyRequestFrequency(getCookie("AuthenticationToken"), onSuccessOfMonthlyRequestFrequency);
}

function getCookie(c_name) {
    var i, x, y, ARRcookies = document.cookie.split(";");
    for (i = 0; i < ARRcookies.length; i++) {
        x = ARRcookies[i].substr(0, ARRcookies[i].indexOf("="));
        y = ARRcookies[i].substr(ARRcookies[i].indexOf("=") + 1);
        x = x.replace(/^\s+|\s+$/g, "");
        if (x == c_name) {
            return unescape(y);
        }
    }
}