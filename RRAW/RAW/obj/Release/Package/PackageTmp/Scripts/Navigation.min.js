function locate(topPos, parentId, childId) {
    selectItem(parentId, childId);

    top.document.getElementById('processing_image').style.top = (topPos + 7) + 'px';
    top.document.getElementById("processing_image").style.display = "block";
}

function hasClass(ele, cls) {
    try {
        return ele.className.match(new RegExp('(\\s|^)' + cls + '(\\s|$)'));
    } catch (e) {
    }
}

function addClass(ele, cls) {
    try {
        if (!this.hasClass(ele, cls)) ele.className += " " + cls;
    } catch (e) {
    }
}

function removeClass(ele, cls) {
    if (hasClass(ele, cls)) {
        var reg = new RegExp('(\\s|^)' + cls + '(\\s|$)');
        ele.className = ele.className.replace(reg, ' ');
    }
}

//Clear Selected Menu / Menu Item
function clearSelections() {
    for (i = 0; i < top.document.getElementsByTagName('a').length - 1; i++) {
        removeClass(top.document.getElementsByTagName('a')[i], 'current-parent');
        removeClass(top.document.getElementsByTagName('a')[i], 'current-child');
    }
    top.document.getElementById('mainFrame').focus();
}

//Select Menu / Menu Item
function selectItem(parentId, childId) {
    clearSelections();

    addClass(top.document.getElementById(parentId), 'current-parent');
    if (childId != null) {
        addClass(top.document.getElementById(childId), 'current-child');
    }
}

//Slide Menu
function slideSubmenu(menuName) {
    if ((document.getElementById(menuName + 'Items').style.display == 'block') && (hasClass(document.getElementById(menuName + 'Menu'), 'current-parent'))) {
        document.getElementById(menuName + 'Items').slideUp();
    }
    else {
        document.getElementById(menuName + 'Items').slideDown();
    }
}
